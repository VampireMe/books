# 3.5.3 保活定时器
***

&emsp;&emsp;
保活定时器通常都是服务器端使用的。
假设有很多客户端连接上了服务端，但这些客户端直接网络断开了，而服务器认为这些客户端一直还存在，在服务器还维持非常多的连接占用资源。
为了解决这个问题，TCP 为每个连接底层维护了一个保活定时器，通常是在没有接受任何分段的 2 个小时后发送一个保活分段。
这个保活分段就是一个带有特殊数据的 ACK 分节或是要求相应的 ACK 分节，结果会有下面这几种：

+ 客户端正常响应，响应正常的 ACK 分节
+ 客户端主机崩溃，现在关闭或者是正在重启，但是在路由表内可见。那么每个 75s 内会重发一次，发送 10 次之后连接超时。
+ 客户端主机崩溃，但是已经启动完毕。那么直接返回 RST 分节
+ 客户端主机正常允许，但是从路由表中删除了。底层 TCP 会接收到 ICMP 的主机不可达错误

&emsp;&emsp;
所有这些错误通知服务端的方式应该都是置连接为可读、可写，然后发起 read/write 时服务端就会检测到这个错误。