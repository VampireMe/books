# 线程控制
***

&emsp;&emsp;
典型的 Unix 进程可以看成只有一个控制线程，一个进程在同一个时刻只允许做一件事情。
使用了线程之后，一个进程就可以持有多个控制线程，允许做多件事情，这样做有很多好处：

+ 为每种事件类型的处理分配单独的线程，这样简化处理异步事件的代码
+ 多个控制线程之间可以共享进程资源，比如内存和文件描述符
+ 多个控制线程可以改善程序的吞吐量，允许多个相互独立的任务交叉运行
+ 交互程序可以显著改善程序的响应时间，用专门线程处理 UI，专门线程处理后端事情

&emsp;&emsp;
线程包含了表示进程内执行环境所必须的信息，其中包括：

+ 线程 ID
+ 寄存器堆
+ 栈
+ 调度优先级和策略
+ 信号屏蔽字
+ errno
+ 线程私有数据

&emsp;&emsp;
共享的进程资源主要包括：

+ text 段
+ 数据段、堆、栈
+ 文件描述符

&emsp;&emsp;
使用的是 POSIX.1-2001 定义的线程接口，pthread or POSIX 线程。
可以使用 \_POSIX\_THREADS/\_SC\_THREADS 来测试是否支持 POSIX 线程。

&emsp;&emsp;
pthread 函数在调用失败的时候通常会返回错误码，它们并不像其他的 POSIX 函数一样设置全局 errno。
同时每个线程拥有一个线程局部的 errno 副本，这样可以和使用了 errno 的现有函数兼容。