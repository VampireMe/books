# 13.2 记录锁
***

&emsp;&emsp;
建议锁和强制锁之间的差别：建议锁更强调协作方面的特性，只是一个软规定。
如果加上强制锁，以阻塞方式来读写就一定会阻塞，这是一个硬性规定。
强制锁和建议锁底层都是记录锁。

&emsp;&emsp;
记录锁 (record locking) 的功能是指当一个进程正在读或是修改文件的某一个部分，它可以阻塞其他进程修改同一个文件区域。
文件区域是指一个范围，可以锁几个字节也可以尝试锁一个文件。

&emsp;&emsp;
记录锁有下面这些属性：

+ 进程终止时，进程建立的锁全部释放
+ 关闭任何一个描述符时，这个描述符可以引用的任何锁都会被释放
+ fork 出来的子进程继承文件描述符却不继承记录锁
+ exec 之后会继承文件描述符和锁。但如果文件标识设置了 close-on-exec，会自动关闭。

&emsp;&emsp;
这里可以看到记录锁是和文件描述符以及进程相关联的，在具体实现里可以看到为什么是这样。