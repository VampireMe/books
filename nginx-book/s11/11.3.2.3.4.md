# 阶段处理回调表
***

&emsp;&emsp;
按照下表顺序将各个模块设置的 phase handler 依次加入 cmcf->phase_engine.handlers 列表，各个 phase 的 phase handler 的 checker 不同。
checker 主要用于限定某个 phase 的框架逻辑，包括处理返回值。

|处理阶段PHASE|checker|可自定义handler|
| --- | --- |
|NGX_HTTP_POST_READ_PHASE|ngx_http_core_generic_phase|是|
|NGX_HTTP_SERVER_REWRITE_PHASE|ngx_http_core_rewrite_phase|是|
|NGX_HTTP_FIND_CONFIG_PHASE|ngx_http_core_find_config_phase|否|
|NGX_HTTP_REWRITE_PHASE|ngx_http_core_rewrite_phase|是|
|NGX_HTTP_POST_REWRITE_PHASE|ngx_http_core_post_rewrite_phase|否|
|NGX_HTTP_PREACCESS_PHASE|ngx_http_core_generic_phase|是|
|NGX_HTTP_ACCESS_PHASE|ngx_http_core_access_phase|是|
|NGX_HTTP_POST_ACCESS_PHASE|ngx_http_core_post_access_phase|否|
|NGX_HTTP_TRY_FILES_PHASE|ngx_http_core_try_files_phase|否|
|NGX_HTTP_CONTENT_PHASE|ngx_http_core_content_phase|是|

&emsp;&emsp;
注意相同 PHASE 的 phase handler 是按模块顺序的反序加入回调表的。
另外在 NGX_HTTP_POST_REWRITE_PHASE 中，ph->next 指向 NGX_HTTP_FIND_CONFIG_PHASE 第一个 phase handler，以实现 rewrite last 逻辑。